
# [Search-based message extension](#tab/search-based-message-extension)

1. Open **Visual Studio Code**.
1. Select **Command Palette...** under the **View** option or **Ctrl+Shift+P**.
1. Select **Teams: Create a New App**.
1. From the dropdown list that appears, select **Message Extension**.
1. Select **Custom Search Results** to download the sample code for a Teams search-based message extension using the latest app manifest (previously called Teams [app manifest](../../resources/schema/manifest-schema.md)).

   :::image type="content" source="../../m365-apps/images/toolkit-palatte-search-sample.png" alt-text="Screenshot shows the Create a new Teams app VS Code command palette to list Teams sample options.":::

   You can also download the sample code from the left pane, under **DEVELOPMENT**, select **View Samples**. A **Samples** tab appears, in the search field enter **NPM Search Connector**.

   :::image type="content" source="../../m365-apps/images/toolkit-search-sample.png" alt-text="Screenshot shows the NPM Search Connector sample in Teams Toolkit Samples gallery.":::

1. Select a preferred programming language.
1. Select a location on your local machine for the workspace folder and enter your application name.
1. Select **Command Palette...** under the **View** option or **Ctrl+Shift+P**.
1. Enter **Teams: Provision** to create the relevant app resources, such as Azure App Service, App Service plan, Azure Bot, and Managed Identity, in your Azure account.
1. Select a subscription and a resource group.
1. Select **Provision**. Alternatively, you can select **Provision** under the **LIFECYCLE** section of the extension.
1. Select **Command Palette...** under the **View** option or **Ctrl+Shift+P**.
1. Enter **Teams: Deploy** to deploy the sample code to the provisioned resources in Azure and start the app. Alternatively, you can select **Deploy** under **LIFECYCLE** section of the extension.
1. Select **Deploy**.

# [Action-based message extension](#tab/action-based-message-extension)

1. Open **Visual Studio Code**.
1. Select **Command Palette...** under the **View** option or **Ctrl+Shift+P**.
1. Select **Teams: Create a New App**.
1. From the dropdown list that appears, select **Message Extension**.
1. Select **Collect Form Input and Process Data** to download the sample code for a Teams action-based message extension using the latest app manifest (previously called Teams [app manifest](../../resources/schema/manifest-schema.md)).

   :::image type="content" source="../../m365-apps/images/toolkit-palatte-action-sample.png" alt-text="Screenshot shows the Create a new Teams app VS Code command palette to list Teams action-based message extension sample option.":::

1. Select preferred programming language.
1. Select a location on your local machine for the workspace folder and enter your application name.
1. Select **Command Palette...** under the **View** option or **Ctrl+Shift+P**.
1. Enter **Teams: Provision** to create the relevant app resources, such as Azure App Service, App Service plan, Azure Bot, and Managed Identity, in your Azure account.
1. Select a subscription and a resource group.
1. Select **Provision**. Alternatively, you can select **Provision** under the **LIFECYCLE** section of the extension.
1. Select **Command Palette...** under the **View** option or **Ctrl+Shift+P**.
1. Enter **Teams: Deploy** to deploy the sample code to the provisioned resources in Azure and start the app. Alternatively, you can select **Deploy** under **LIFECYCLE** section of the extension.
1. Select **Deploy**.

---
