### YamlMime:Tutorial
title: Create Teams workflow bot
metadata:
  title: Create Teams workflow bot
  description: With this learning module, you'll learn to create a workflow bot in Microsoft Teams with the Adaptive Card action handler feature.
  audience: Developer
  level: Beginner
  ms.date: 28/09/2022
  ms.topic: interactive-tutorial
  nextTutorialHref: toolkit/teams-toolkit-tutorial.md
  nextTutorialTitle: Teams app tutorials
  ms.custom: mvc
  ms.localizationpriority: null
items:
- durationInMinutes: 1
  content: |
    The workflow bot allows users to interact with an Adaptive Card enabled by the Adaptive Card action handler feature in the workflow bot app. When you respond to the triggered Adaptive Card action, then a sequential workflow is completed.
    When you get an Adaptive Card, it provides one or more buttons in the card for your input. You can also call an API, and then send another Adaptive Card in your conversation in response to the card action.
    In this tutorial, you'll learn:
      * How to build workflow bot with Teams Toolkit.
      * About the directory structure of your app.
    
    You can see the following output:
    
    :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-final-output.png" alt-text="Screenshot shows the workflow bot output.":::
- title: Prerequisites
  durationInMinutes: 1
  content: |
    Here's a list of tools you need for building and deploying your apps.

    | &nbsp; | Install | For using |
    | --- | --- | --- |
    | **Required** | &nbsp; | &nbsp; |
    | &nbsp; | [Visual Studio Code](https://code.visualstudio.com/download) | JavaScript or TypeScript, build environments. Use the latest version. |
    | &nbsp; | [Teams Toolkit](#install-the-teams-toolkit) | A Microsoft Visual Studio Code extension that creates a project scaffolding for your app. Use the latest version.|
    | &nbsp; | [Node.js](https://nodejs.org/en/download/) | Back-end JavaScript runtime environment. For more information, see [Node.js version compatibility table for project type](~/toolkit/build-environments.md#nodejs-version-compatibility-table-for-project-type).|
    | &nbsp; | [Microsoft Teams](https://www.microsoft.com/microsoft-teams/download-app) | Microsoft Teams to collaborate with everyone you work with through apps for chat, meetings, call and all in one place.|
    | &nbsp; | [Microsoft&nbsp;Edge](https://www.microsoft.com/edge) (recommended) or [Google Chrome](https://www.google.com/chrome/) | A browser with developer tools. |
    | &nbsp; | [Microsoft 365 developer account](/microsoftteams/platform/concepts/build-and-test/prepare-your-o365-tenant) | Access to Teams account with the appropriate permissions to install an app. |
    > [!NOTE]
    > The guide is tested on Teams Toolkit latest version and Nodejs version 14 and 16. The steps in this guide may work with other versions, but that hasn't been tested.
    
    [!INCLUDE [Set up prerequisites](includes/get-started/prepare-teams-toolkit.md)]

- title: Build workflow bot
  durationInMinutes: 5
  content: |
    To build workflow bot using Visual Studio Code, perform the following steps:
    1. Open Visual Studio Code.
    1. Select the **Teams Toolkit** :::image type="icon" source="../msteams-platform/assets/images/teams-toolkit-v2/teams-toolkit-sidebar-icon.png"::: icon in the Visual Studio Code **Activity Bar**.
    1. Select **Create a New App**.
      
        :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-create.png" alt-text="Screenshots shows the creation of new teams app in side panel.":::
    
    1. Select **Bot** to create a new bot project.
    
        :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-teams-app.png" alt-text=" Screenshots the selection option to create a new teams app.":::
    
    1. Select **Sequential Workflow in Chat** as the app feature that you want to build in your app.

        :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-capabilities-workflow.png" alt-text=" Screenshot shows the selection of App Features Using a Bot.":::
    
    1. Select **TypeScript** as the programming language.
    
        :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-program-lang.png" alt-text=" Screenshots shows the selection of type script for programming language.":::
    
    1. Select **Default folder** to store your project root folder in default location.
        > [!NOTE]
        > You can also change the default location by selecting **Browse...**
        
        :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-workspace-folder.png" alt-text=" Screenshots shows the selection to add workspace folder.":::
       
    1. Enter a suitable name for your app.
              
        :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-app-name.png" alt-text="Screenshots shows  to enter application name.":::
    
    1. Select **Enter**.
        
    1. The workflow bot is created in a few seconds, and you can see the scaffolding.
        
        :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-scaffolding1.png" alt-text="Screenshot shows your app is created with the scaffolding visible in the side panel.":::
    
    1. Select **Run and Debug** :::image type="icon" source="../msteams-platform/assets/images/teams-toolkit-v2/run-debug-icon.png"::: icon from the Visual Studio Code **Activity Bar**.
    
    1. Select **Debug (Edge)** or **Debug (Chrome)** from the dropdown list.
    
       :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-local-debug1.png" alt-text="Screenshot shows your app is created with the scaffolding visible in the side panel.":::    
    
    1. Select **Start Debugging**.
    
    1. Select **Add** or use the dropdown menu to add your workflow bot app to a team, chat, or meeting.

     :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-add-app.png" alt-text="Screenshot shows the selection to add your workflow bot app.":::
    ### Take tour of source code
    Teams Toolkit provides components for building an app. After creating the project, you can view the project folders and files in the Explorer area of Visual Studio Code for JavaScript/TypeScript. 
    
    :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-scaffolding2.png" alt-text="Screenshot shows the selection to add your workflow bot app.":::
    
    
    The created bot is a normal TeamsFx project that contains following folders:
    
    | Folder / File | Contents |
    | - | - |
    | `teamsapp.yml` | Main project file describes your application configuration and defines the set of actions to run in each lifecycle stages. |
    | `teamsapp.local.yml`| This overrides `teamsapp.yml` with actions that enable local execution and debugging. |
    | `env/`| Name / value pairs are stored in environment files and used by `teamsapp.yml` to customize the provisioning and deployment rules. |
    | `.vscode/` | VSCode files for debugging. |
    | `appPackage/` | Templates for the Teams application manifest. |
    | `infra/` | Templates for provisioning Azure resources. |
    | `src/` | The source code for the application. |
    | `src/index.js`| Application entry point and `restify` handlers for the Workflow bot. |
    | `src/teamsBot.js` | An empty teams activity handler for bot customization. |
    | `src/commands/helloworldCommandHandler.js` | Implementation that handles responding to a chat command. |
    | `src/adaptiveCards/helloworldCommandResponse.json` | Defines the Adaptive Card (UI) that is displayed in response to a chat command. |
    | `src/adaptiveCards/doStuffActionResponse.json` | A generated Adaptive Card that is sent to Teams for the response of "doStuff" action. |
    | `src/cardActions/doStuffActionHandler.js` | Implements the handler for the `doStuff` button displayed in the Adaptive Card. |
    
    
- title: Interaction with the workflow bot
  durationInMinutes: 2
  content: |
    You can interact with the bot in Teams by sending a helloWorld command.
    
    :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-action-response.png" alt-text="Screenshot shows the selection to add your workflow bot app.":::

    You'll receive the following command response in Adaptive Card:

     :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-debug-output1.png" alt-text="Screenshot shows the selection to add your workflow bot app.":::
    
    Then you can select the **DoStuff** button to invoke the action, that responds with the following updated Adaptive Card:

     :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-debug-output2.png" alt-text="Screenshot shows the selection to add your workflow bot app.":::
       
- title: Complete challenge
  durationInMinutes: 1
  content: |
    Did you come up with something like this?

    :::image type="content" source="./assets/images/sbs-workflow-bot/sbs-workflow-bot-debug-output2.png" alt-text="Screenshot shows the selection to add your workflow bot app.":::
    
- content: |
    You've completed the tutorial to get started with workflow bot for Microsoft Teams.
