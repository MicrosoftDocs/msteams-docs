{"version":3,"sources":["styles/getStyles.ts"],"names":["isDebugEnabled","resolveVariables","resolveStyles","getStyles","options","primaryDisplayName","telemetry","telemetryPartStart","enabled","performance","now","resolvedVariables","allDisplayNames","theme","inlineStylesProps","variables","enableVariablesCaching","msResolveVariablesTotal","classes","resolvedStyles","resolvedStylesDebug","process","env","NODE_ENV","saveDebug","componentName","join","componentVariables","_debug","resolved","componentStyles","siteVariables","siteVars","keys","Object","length","pop","styles"],"mappings":";;AAAA,SAAgEA,cAAhE,QAAsF,kBAAtF;AAKA,SAASC,gBAAT,QAAiC,oBAAjC;AACA,SAASC,aAAT,QAA8B,iBAA9B;AASA,OAAO,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,OAAD,EAAoD;AAC3E,MAAQC,kBAAR,GAA0CD,OAA1C,CAAQC,kBAAR;AAAA,MAA4BC,SAA5B,GAA0CF,OAA1C,CAA4BE,SAA5B,CAD2E,CAG3E;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAMC,kBAAkB,GAAGD,SAAS,QAAT,IAAAA,SAAS,CAAEE,OAAX,GAAqBC,WAAW,CAACC,GAAZ,EAArB,GAAyC,CAApE;AACA,MAAMC,iBAAiB,GAAGV,gBAAgB,CACxCG,OAAO,CAACQ,eADgC,EAExCR,OAAO,CAACS,KAFgC,EAGxCT,OAAO,CAACU,iBAAR,CAA0BC,SAHc,EAIxCX,OAAO,CAACK,WAAR,CAAoBO,sBAJoB,CAA1C;;AAOA,MAAIV,SAAS,QAAT,IAAAA,SAAS,CAAEE,OAAX,IAAsBF,SAAS,CAACG,WAAV,CAAsBJ,kBAAtB,CAA1B,EAAqE;AACnEC,IAAAA,SAAS,CAACG,WAAV,CAAsBJ,kBAAtB,EAA0CY,uBAA1C,IAAqER,WAAW,CAACC,GAAZ,KAAoBH,kBAAzF;AACD;;AAED,uBAAyDL,aAAa,CAACE,OAAD,EAAUO,iBAAV,CAAtE;AAAA,MAAQO,OAAR,kBAAQA,OAAR;AAAA,MAAiBC,cAAjB,kBAAiBA,cAAjB;AAAA,MAAiCC,mBAAjC,kBAAiCA,mBAAjC,CAtB2E,CAwB3E;;;AACA,MAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,IAAyCvB,cAA7C,EAA6D;AAC3DI,IAAAA,OAAO,CAACoB,SAAR,CAAkB;AAChBC,MAAAA,aAAa,EAAErB,OAAO,CAACQ,eAAR,CAAwBc,IAAxB,CAA6B,GAA7B,CADC;AAEhBC,MAAAA,kBAAkB,EAAE,QAAShB,iBAAiB,CAACiB,MAA3B,EAAmC,UAAAb,SAAS;AAAA,eAAI,CAAC,SAAUA,SAAS,CAACc,QAApB,CAAL;AAAA,OAA5C,CAFJ;AAGhBC,MAAAA,eAAe,EAAEV,mBAHD;AAIhBW,MAAAA,aAAa,EAAE,QAAS3B,OAAO,CAACS,KAAR,CAAckB,aAAd,CAA4BH,MAArC,EAA6C,UAAAI,QAAQ,EAAI;AACtE,YAAI,SAAUA,QAAV,KAAuB,SAAUA,QAAQ,CAACH,QAAnB,CAA3B,EAAyD;AACvD,iBAAO,KAAP;AACD;;AAED,YAAMI,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYD,QAAQ,CAACH,QAArB,CAAb;;AACA,YAAII,IAAI,CAACE,MAAL,KAAgB,CAAhB,IAAqBF,IAAI,CAACG,GAAL,OAAe,WAApC,IAAmD,SAAUJ,QAAQ,CAACH,QAAT,CAAkB,WAAlB,CAAV,CAAvD,EAAkG;AAChG,iBAAO,KAAP;AACD;;AAED,eAAO,IAAP;AACD,OAXc;AAJC,KAAlB;AAiBD;;AAED,SAAO;AACLX,IAAAA,OAAO,EAAPA,OADK;AAELH,IAAAA,SAAS,EAAEJ,iBAFN;AAGL0B,IAAAA,MAAM,EAAElB,cAHH;AAILN,IAAAA,KAAK,EAAET,OAAO,CAACS;AAJV,GAAP;AAMD,CAnDM","sourcesContent":["import { ComponentSlotStylesResolved, ComponentVariablesObject, isDebugEnabled } from '@fluentui/styles';\nimport * as _ from 'lodash';\n\nimport { ProviderContextPrepared } from '../context';\nimport { ComponentSlotClasses, ResolveStylesOptions } from '../styles/types';\nimport { resolveVariables } from './resolveVariables';\nimport { resolveStyles } from './resolveStyles';\n\nexport type GetStylesResult = {\n  classes: ComponentSlotClasses;\n  variables: ComponentVariablesObject;\n  styles: ComponentSlotStylesResolved;\n  theme: ProviderContextPrepared['theme'];\n};\n\nexport const getStyles = (options: ResolveStylesOptions): GetStylesResult => {\n  const { primaryDisplayName, telemetry } = options;\n\n  //\n  // To compute styles we are going through three stages:\n  // - resolve variables (siteVariables => componentVariables + props.variables)\n  // - resolve styles (with resolvedVariables & props.styles & props.design)\n  // - compute classes (with resolvedStyles)\n  // - conditionally add sources for evaluating debug information to component\n\n  const telemetryPartStart = telemetry?.enabled ? performance.now() : 0;\n  const resolvedVariables = resolveVariables(\n    options.allDisplayNames,\n    options.theme,\n    options.inlineStylesProps.variables,\n    options.performance.enableVariablesCaching,\n  );\n\n  if (telemetry?.enabled && telemetry.performance[primaryDisplayName]) {\n    telemetry.performance[primaryDisplayName].msResolveVariablesTotal += performance.now() - telemetryPartStart;\n  }\n\n  const { classes, resolvedStyles, resolvedStylesDebug } = resolveStyles(options, resolvedVariables);\n\n  // conditionally add sources for evaluating debug information to component\n  if (process.env.NODE_ENV !== 'production' && isDebugEnabled) {\n    options.saveDebug({\n      componentName: options.allDisplayNames.join(':'),\n      componentVariables: _.filter(resolvedVariables._debug, variables => !_.isEmpty(variables.resolved)),\n      componentStyles: resolvedStylesDebug,\n      siteVariables: _.filter(options.theme.siteVariables._debug, siteVars => {\n        if (_.isEmpty(siteVars) || _.isEmpty(siteVars.resolved)) {\n          return false;\n        }\n\n        const keys = Object.keys(siteVars.resolved);\n        if (keys.length === 1 && keys.pop() === 'fontSizes' && _.isEmpty(siteVars.resolved['fontSizes'])) {\n          return false;\n        }\n\n        return true;\n      }),\n    });\n  }\n\n  return {\n    classes,\n    variables: resolvedVariables,\n    styles: resolvedStyles,\n    theme: options.theme,\n  };\n};\n"],"file":"getStyles.js"}