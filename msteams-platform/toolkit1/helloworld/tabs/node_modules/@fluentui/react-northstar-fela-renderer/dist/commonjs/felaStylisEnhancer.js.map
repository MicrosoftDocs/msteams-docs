{"version":3,"sources":["felaStylisEnhancer.ts"],"names":["Stylis","_Stylis","default","stylis","cascade","compress","global","keyframe","preserve","semicolon","felaStylisEnhancer","renderer","existingEmitChange","_emitChange","bind","change","type","RULE_TYPE","prefixed","declaration","slice"],"mappings":";;;;;;;AAAA;;AAEA;;AADA;AAKA;AACA;AACA,IAAMA,MAAM,GAAIC,eAAD,CAAiBC,OAAjB,IAA4BD,eAA3C,C,CAEA;;AACA,IAAME,MAAM,GAAG,IAAIH,MAAJ,CAAW;AACxBI,EAAAA,OAAO,EAAE,KADe;AAExBC,EAAAA,QAAQ,EAAE,KAFc;AAGxBC,EAAAA,MAAM,EAAE,KAHgB;AAIxBC,EAAAA,QAAQ,EAAE,KAJc;AAKxBC,EAAAA,QAAQ,EAAE,KALc;AAMxBC,EAAAA,SAAS,EAAE;AANa,CAAX,CAAf;;AASO,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,QAAD,EAA4B;AAC5D,MAAMC,kBAAkB,GAAGD,QAAQ,CAACE,WAAT,CAAqBC,IAArB,CAA0BH,QAA1B,CAA3B;;AAEAA,EAAAA,QAAQ,CAACE,WAAT,GAAuB,UAACE,MAAD,EAAgC;AACrD,QAAIA,MAAM,CAACC,IAAP,KAAgBC,oBAApB,EAA+B;AAC7B,UAAMC,QAAgB,GAAGf,MAAM,CAAC,EAAD,EAAKY,MAAM,CAACI,WAAZ,CAA/B,CAD6B,CAG7B;;AACAJ,MAAAA,MAAM,CAACI,WAAP,GAAqBD,QAAQ,CAACE,KAAT,CAAe,CAAf,EAAkB,CAAC,CAAnB,CAArB;AACD;;AAEDR,IAAAA,kBAAkB,CAACG,MAAD,CAAlB;AACD,GATD;;AAWA,SAAOJ,QAAP;AACD,CAfM","sourcesContent":["import { RULE_TYPE } from 'fela-utils';\n// @ts-ignore\nimport _Stylis from 'stylis';\n\nimport { FelaRenderer, FelaRendererChange } from './types';\n\n// `stylis@3` is a CJS library, there are known issues with them:\n// https://github.com/rollup/rollup/issues/1267#issuecomment-446681320\nconst Stylis = (_Stylis as any).default || _Stylis;\n\n// We use Stylis only for vendor prefixing, all other capabilities are disabled\nconst stylis = new Stylis({\n  cascade: false,\n  compress: false,\n  global: false,\n  keyframe: false,\n  preserve: false,\n  semicolon: false,\n});\n\nexport const felaStylisEnhancer = (renderer: FelaRenderer) => {\n  const existingEmitChange = renderer._emitChange.bind(renderer);\n\n  renderer._emitChange = (change: FelaRendererChange) => {\n    if (change.type === RULE_TYPE) {\n      const prefixed: string = stylis('', change.declaration);\n\n      // Fela uses objects by references, it's safe to override properties\n      change.declaration = prefixed.slice(1, -1);\n    }\n\n    existingEmitChange(change);\n  };\n\n  return renderer;\n};\n"],"file":"felaStylisEnhancer.js"}